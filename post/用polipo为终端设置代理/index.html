<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Beautiful Hugo</title>
  <meta property="og:title" content="Beautiful Hugo" />
  <meta name="twitter:title" content="Beautiful Hugo" />
  <meta name="description" content="用polipo为终端设置代理 做开发的同学，应该都会经常接触终端，有些时候我们在终端会做一些网络操作，比如下载gradle包等，由于一些原因，某些网络操作不是那么理想，这时候我们就需要设置代理来自由地访问网络。 Shadowsocks是我们常用的代理工具，它使用socks5协议，而终端很多工具目前只支持http和https等协议，对socks5协议支持不够好，所以我们为终端设置shadowsocks的思路就是将socks协议转换成http协议，然后为终端设置即可。仔细想想也算是适配器模式的一种现实应用吧。 想要进行转换，需要借助工具，这里我们采用比较知名的polipo来实现。polipo是一个轻量级的缓存web代理程序。闲话休叙，让我们开始动手吧。 安装 Fedora安装 1 sudo yum install polipo Mac下使用Homebrew安装 1 brew install polipo Ubuntu安装 1 sudo apt-get install polipo 修改配置(Linux) 如下打开配置文件 1 sudo vim /etc/polipo/config 设置ParentProxy为Shadowsocks，通常情况下本机shadowsocks的地址如下
Uncomment this if you want to use a parent SOCKS proxy: socksParentProxy = &ldquo;localhost:1080&rdquo; socksProxyType = socks5 设置日志输出文件 1 2 logFile=/var/log/polipo logLevel=4 修改配置(Mac) 设置每次登陆启动polipo 1 ln -sfv /usr/local/opt/polipo/*.plist ~/Library/LaunchAgents 修改文件/usr/local/opt/polipo/homebrew.mxcl.polipo.plist设置parentProxy
&lt;?xml version=&ldquo;1.0&rdquo; encoding=&ldquo;UTF-8&rdquo;?&gt; &lt;!DOCTYPE plist PUBLIC &ldquo;-//Apple//DTD PLIST 1.0//EN&rdquo; &ldquo;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;  Label homebrew.">
  <meta property="og:description" content="用polipo为终端设置代理 做开发的同学，应该都会经常接触终端，有些时候我们在终端会做一些网络操作，比如下载gradle包等，由于一些原因，某些网络操作不是那么理想，这时候我们就需要设置代理来自由地访问网络。 Shadowsocks是我们常用的代理工具，它使用socks5协议，而终端很多工具目前只支持http和https等协议，对socks5协议支持不够好，所以我们为终端设置shadowsocks的思路就是将socks协议转换成http协议，然后为终端设置即可。仔细想想也算是适配器模式的一种现实应用吧。 想要进行转换，需要借助工具，这里我们采用比较知名的polipo来实现。polipo是一个轻量级的缓存web代理程序。闲话休叙，让我们开始动手吧。 安装 Fedora安装 1 sudo yum install polipo Mac下使用Homebrew安装 1 brew install polipo Ubuntu安装 1 sudo apt-get install polipo 修改配置(Linux) 如下打开配置文件 1 sudo vim /etc/polipo/config 设置ParentProxy为Shadowsocks，通常情况下本机shadowsocks的地址如下
Uncomment this if you want to use a parent SOCKS proxy: socksParentProxy = &ldquo;localhost:1080&rdquo; socksProxyType = socks5 设置日志输出文件 1 2 logFile=/var/log/polipo logLevel=4 修改配置(Mac) 设置每次登陆启动polipo 1 ln -sfv /usr/local/opt/polipo/*.plist ~/Library/LaunchAgents 修改文件/usr/local/opt/polipo/homebrew.mxcl.polipo.plist设置parentProxy
&lt;?xml version=&ldquo;1.0&rdquo; encoding=&ldquo;UTF-8&rdquo;?&gt; &lt;!DOCTYPE plist PUBLIC &ldquo;-//Apple//DTD PLIST 1.0//EN&rdquo; &ldquo;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;  Label homebrew.">
  <meta name="twitter:description" content="用polipo为终端设置代理 做开发的同学，应该都会经常接触终端，有些时候我们在终端会做一些网络操作，比如下载gradle包等，由于一些原因，某些网络操作不是那么理想，这时候我们就需要设置代理来自由地访问网络。 Shadowsocks是我们常用的代理工具，它使用socks5协议，而终端很多工具目前只支持http和https等协议，对socks5协议支持不够好，所以我们为终端设 …">
  <meta name="author" content=""/>
  <link href='//tx991020.github.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="//tx991020.github.io/img/avatar-icon.png" />
  <meta name="twitter:image" content="//tx991020.github.io/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="//tx991020.github.io/post/%E7%94%A8polipo%E4%B8%BA%E7%BB%88%E7%AB%AF%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Beautiful Hugo" />

  <meta name="generator" content="Hugo 0.19" />
  <link rel="canonical" href="//tx991020.github.io/post/%E7%94%A8polipo%E4%B8%BA%E7%BB%88%E7%AB%AF%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/" />
  <link rel="alternate" href="//tx991020.github.io/index.xml" type="application/rss+xml" title="Beautiful Hugo">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="//tx991020.github.io/css/main.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="//tx991020.github.io/css/pygment_highlights.css" />
  <link rel="stylesheet" href="//tx991020.github.io/css/highlight.min.css" />


</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="//tx991020.github.io">Beautiful Hugo</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Samples</a>
              <div class="navlinks-children">
                
                  <a href="/post/2017-03-07-bigimg-sample">Big Image Sample</a>
                
                  <a href="/post/2017-03-05-math-sample">Math Sample</a>
                
                  <a href="/post/2016-03-08-code-sample">Code Sample</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        
        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Beautiful Hugo" href="//tx991020.github.io">
            <img class="avatar-img" src="//tx991020.github.io/img/avatar-icon.png" alt="Beautiful Hugo" />
          </a>
        
      </div>
    </div>

  </div>
</nav>



    
  
  
  




  <div class="intro-header"></div>


    <div class="container" role="main">
      
        <div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        

<h1 id="用polipo为终端设置代理">用polipo为终端设置代理</h1>

<p>做开发的同学，应该都会经常接触终端，有些时候我们在终端会做一些网络操作，比如下载gradle包等，由于一些原因，某些网络操作不是那么理想，这时候我们就需要设置代理来自由地访问网络。
Shadowsocks是我们常用的代理工具，它使用socks5协议，而终端很多工具目前只支持http和https等协议，对socks5协议支持不够好，所以我们为终端设置shadowsocks的思路就是将socks协议转换成http协议，然后为终端设置即可。仔细想想也算是适配器模式的一种现实应用吧。
想要进行转换，需要借助工具，这里我们采用比较知名的polipo来实现。polipo是一个轻量级的缓存web代理程序。闲话休叙，让我们开始动手吧。
安装
Fedora安装
1
sudo yum install polipo
Mac下使用Homebrew安装
1
brew install polipo
Ubuntu安装
1
sudo apt-get install polipo
修改配置(Linux)
如下打开配置文件
1
sudo vim /etc/polipo/config
设置ParentProxy为Shadowsocks，通常情况下本机shadowsocks的地址如下</p>

<h1 id="uncomment-this-if-you-want-to-use-a-parent-socks-proxy">Uncomment this if you want to use a parent SOCKS proxy:</h1>

<p>socksParentProxy = &ldquo;localhost:1080&rdquo;
socksProxyType = socks5
设置日志输出文件
1
2
logFile=/var/log/polipo
logLevel=4
修改配置(Mac)
设置每次登陆启动polipo
1
ln -sfv /usr/local/opt/polipo/*.plist ~/Library/LaunchAgents
修改文件/usr/local/opt/polipo/homebrew.mxcl.polipo.plist设置parentProxy</p>

<p>&lt;?xml version=&ldquo;1.0&rdquo; encoding=&ldquo;UTF-8&rdquo;?&gt;
&lt;!DOCTYPE plist PUBLIC &ldquo;-//Apple//DTD PLIST 1.0//EN&rdquo; &ldquo;<a href="http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;">http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</a>
<plist version="1.0">
  <dict>
    <key>Label</key>
    <string>homebrew.mxcl.polipo</string>
    <key>RunAtLoad</key>
    <true/>
    <key>KeepAlive</key>
    <true/>
    <key>ProgramArguments</key>
    <array>
        <string>/usr/local/opt/polipo/bin/polipo</string>
        <string>socksParentProxy=localhost:1080</string>
    </array>
    <!-- Set `ulimit -n 20480`. The default OS X limit is 256, that's
         not enough for Polipo (displays 'too many files open' errors).
         It seems like you have no reason to lower this limit
         (and unlikely will want to raise it). -->
    <key>SoftResourceLimits</key>
    <dict>
      <key>NumberOfFiles</key>
      <integer>20480</integer>
    </dict>
  </dict>
</plist>
修改的地方是增加了<string>socksParentProxy=localhost:1080</string>
启动（Linux）
先关闭正在运行的polipo，然后再次启动
1
2
sudo service polipo stop
sudo service polipo start
启动(Mac)
1
2
launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.polipo.plist
launchctl load ~/Library/LaunchAgents/homebrew.mxcl.polipo.plis
注意：请确保Shadowsocks正常工作。
验证及使用
安装完成就需要进行验证是否work。这里展示一个最简单的验证方法，打开终端，如下执行</p>

<p>07:56:24-androidyue/var/log$ curl ip.gs
当前 IP：125.39.112.15 来自：中国天津天津 联通
08:09:23-androidyue/var/log$ http_proxy=<a href="http://localhost:8123">http://localhost:8123</a> curl ip.gs
当前 IP：210.140.193.128 来自：日本日本
如上所示，为某个命令设置代理，前面加上http_proxy=<a href="http://localhost:8123">http://localhost:8123</a> 后接命令即可。
注：8123是polipo的默认端口，如有需要，可以修改成其他有效端口。
设置别名
bash中有一个很好的东西，就是别名alias. Linux用户修改~/.bashrc，Mac用户修改~/.bash_profile文件，增加如下设置
1
alias hp=&ldquo;http_proxy=<a href="http://localhost:8123&quot;">http://localhost:8123&quot;</a>
然后Linux用户执行source ~/.bashrc，Mac用户执行source ~/.bash_profile
测试使用</p>

<p>20:39:39-androidyue~$ curl ip.gs
当前 IP：125.39.112.14 来自：中国天津天津 联通
20:39:44-androidyue~$ hp curl ip.gs
当前 IP：210.140.193.128 来自：日本日本
20:39:48-androidyue~$
当前会话全局设置
如果嫌每次为每一个命令设置代理比较麻烦，可以为当前会话设置全局的代理。即使用export http_proxy=<a href="http://localhost:8123即可。">http://localhost:8123即可。</a> 如果想撤销当前会话的http_proxy代理，使用 unset http_proxy 即可。 示例效果如下</p>

<p>21:29:49-androidyue~$ curl ip.gs
当前 IP：125.39.112.14 来自：中国天津天津 联通
21:29:52-androidyue~$ export http_proxy=<a href="http://localhost:8123">http://localhost:8123</a>
21:30:07-androidyue~$ curl ip.gs
当前 IP：210.140.193.128 来自：日本日本
21:30:12-androidyue~$ unset http_proxy
21:30:37-androidyue~$ curl ip.gs
当前 IP：125.39.112.14 来自：中国天津天津 联通
如果想要更长久的设置代理，可以将export http_proxy=<a href="http://localhost:8123加入.bashrc或者.bash_profile文件">http://localhost:8123加入.bashrc或者.bash_profile文件</a>
设置Git代理
复杂一些的设置Git代理</p>

<p>git clone <a href="https://android.googlesource.com/tools/repo">https://android.googlesource.com/tools/repo</a> &ndash;config http.proxy=localhost:8123</p>

<p>Cloning into &lsquo;repo&rsquo;&hellip;
remote: Counting objects: 135, done
remote: Finding sources: 100% (<sup>135</sup>&frasl;<sub>135</sub>)
remote: Total 3483 (delta 1956), reused 3483 (delta 1956)
Receiving objects: 100% (<sup>3483</sup>&frasl;<sub>3483</sub>), 2.63 MiB | 492 KiB/s, done.
Resolving deltas: 100% (<sup>1956</sup>&frasl;<sub>1956</sub>), done.
其实这样还是比较复杂，因为需要记忆的东西比较多，下面是一个更简单的实现
首先，在.bashrc或者.bash_profile文件加入这一句。
1
gp=&rdquo; &ndash;config http.proxy=localhost:8123&rdquo;
然后执行source操作，更新当前bash配置。
更简单的使用git的方法</p>

<p>git clone  <a href="https://android.googlesource.com/tools/repo">https://android.googlesource.com/tools/repo</a> $gp</p>

<p>Cloning into &lsquo;repo&rsquo;&hellip;
remote: Counting objects: 135, done
remote: Finding sources: 100% (<sup>135</sup>&frasl;<sub>135</sub>)
remote: Total 3483 (delta 1956), reused 3483 (delta 1956)
Receiving objects: 100% (<sup>3483</sup>&frasl;<sub>3483</sub>), 2.63 MiB | 483 KiB/s, done.
Resolving deltas: 100% (<sup>1956</sup>&frasl;<sub>1956</sub>), done.
开始自由快速的开发吧</p>

      </article>

      <ul class="pager blog-pager">
        
        
          <li class="next">
            <a href="//tx991020.github.io/post/%E6%AD%A3%E5%88%992/" data-toggle="tooltip" data-placement="top" title="">Next Post &rarr;</a>
          </li>
        
      </ul>

      
        
      

    </div>
  </div>
</div>

      
    </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:tx991020@gmail.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/tx991020" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="//tx991020.github.io/index.xml" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
          &nbsp;&bull;&nbsp;
          2017

          
            &nbsp;&bull;&nbsp;
            <a href="//tx991020.github.io">Beautiful Hugo</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.19</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="//tx991020.github.io/js/main.js"></script>
<script src="//tx991020.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> renderMathInElement(document.body); </script>








  </body>
</html>
